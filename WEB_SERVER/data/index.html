<!DOCTYPE html>
<html>

    <head>
        <title>web app</title>
        <link rel="stylesheet" href="style.css">
    </head>

    <body>
        <!-- <div class="flex_column"> -->
        <!--firsrbar -->
        <div class="header flex_row">
            <!-- account -->
         <div class="account flex_column center">
            <div class="profile"></div>
            <h2>Ali478qwe</h2>
         </div>
         <!-- setting -->
          <div class="setting flex_column center">
           <div class="setting_icon"></div>
           <h2>SETTING</h2>
          </div>
        </div>
        <!--item box -->
        <div class="item_box center flex_row">
            <div class="item flex_column center">
                <div class="item_title_bar flex_row center">
                    <img class="icon" src="icon/thermometer.png">
                    <h2>Temp Oil</h2>
                </div>
                <div class="count_bar flex_row center">
                <h1 id="temp_oil">50</h1>
                <h3>.c</h3>
            </div>
            </div>
            <div class="item flex_column center">
                <div class="item_title_bar flex_row center">
                    <img class="icon" src="icon/coolant.png">
                    <h2>Level Oil</h2>
                    </div>
          <div class="count_bar flex_row center">
                <h1 id="level_oil">1.5</h1>
                <h3>.li</h3>
            </div>
            </div>
            <div class="item flex_column center">
                <div class="item_title_bar flex_row center">
                    <img class="icon" src="icon/wind.png">
                    <h2>Temp Air</h2>
                </div>
            <div class="count_bar flex_row center">
                <h1 id="temp_air">50</h1>
                <h3>.c</h3>
            </div>
            </div>
        </div>
    <div class="management">
        <div class="notification flex_column center">
            <div class="data flex_row center">
                <img class="icon" src="icon/list.png">
                <h1>DATA</h1>

            </div>
            <div class="notif_item_box flex center gap_10">
                <div class="flex_column gap">
                    <div class="notif_box flex_row center gap_10">
                        <div class="dot" style="background-color: orange;"></div>
                        <h4>message</h4>
                    </div>
                    <div class="notif_box flex_row center gap_10">
                        <div class="dot" style="background-color: red;"></div>
                        <h4>sim ok</h4>
                    </div>
                    <div class="notif_box flex_row center gap_10">
                        <div class="dot" style="background-color: yellowgreen"></div>
                        <h4>message</h4>
                        </div>    
                </div>
                <div class="flex_column gap">
                    <div class="notif_box flex_row center gap_10">
                        <div class="dot" style="background-color:darkmagenta;"></div>
                        <h4>charge</h4>
                    </div>
                    <div class="notif_box flex_row center gap_10">
                        <div class="dot" style="background-color:lightseagreen;"></div>
                        <h4>call notif</h4>
                    </div>
                    <div class="notif_box flex_row center gap_10">
                        <div class="dot" style="background-color:lightcoral;"></div>
                        <h4>password</h4>
                    </div>    
                </div>
                <div class="flex_column gap">
                    <div class="notif_box flex_row center gap_10">
                        <div class="dot" style="background-color:brown;"></div>
                        <h4>message</h4>
                    </div>
                    <div class="notif_box flex_row center gap_10">
                        <div class="dot" style="background-color:cornflowerblue;"></div>
                        <h4>sim ok</h4>
                    </div>
                    <div class="notif_box flex_row center gap_10">
                        <div class="dot" style="background-color: gold;"></div>
                        <h4>message</h4>
                    </div>    
                </div>
        </div>
    </div>
        <div class="runtime flex_column center">
           
        <div class="flex_row heigth">
         <img class="control_icon" src="icon/time.png">
        <h2>Run Time</h2>
        
        </div>
        <div class="count_bar flex_row center">
           <h1>23</h1>
           <h3>.min</h3>
        </div>
        </div>
        <div class="battery zero_margin flex_column center">
        <div class="flex_row heigth">
        <img src="icon/battery.png" class="control_icon">
        <h2>Battrey</h2>
        
        </div>
        <div class="count_bar flex_row center">
           <h1 id="voltage_battery">50</h1>
           <h3>.volt</h3>
        </div>
        </div>
        <div class="control flex_column center">
            <div class="flex center"><img  src="icon/moon_1.png" class="control_icon"></div>
            <div class="flex center"><img  src="icon/message.png" class="control_icon"></div>
            <div class="flex center"><img  src="icon/phone.png" class="control_icon"></div>
            <div class="flex center"><img  src="icon/check_mark.png" class="control_icon"></div>
        </div>
        <div class="noting">
            <h1 id="cmd"></h1>
        </div>
    </div>
    <!-- </div> -->
    </body>
    <script>

        function updateUI(data) {
    document.getElementById("level_oil").innerText = data.level_oil;
    document.getElementById("temp_oil").innerText = data.temp_oil;
    document.getElementById("temp_air").innerText = data.temp_air;
    document.getElementById("voltage_battery").innerText = data.voltage_battery;
}

const socket = new WebSocket("ws://localhost:8080");

// وقتی اتصال باز شد
socket.addEventListener("open", () => {
    console.log("Connected to ESP32 WebSocket");
});

// وقتی پیامی دریافت شد
socket.addEventListener("message", (event) => {
    console.log("Data received from ESP32:", event.data);
    try {
        const json = JSON.parse(event.data);
        updateUI(json); // داده‌ها را به UI منتقل کن
    } catch (e) {
        console.error("Invalid JSON", e);
    }
});

// وقتی اتصال بسته شد
socket.addEventListener("close", () => {
    console.log("WebSocket closed");
});

    </script>
</html>